(function(a){a.ui.define("toolbar",{_data:{title:"",backButtonText:"\u8fd4\u56de",backButtonHref:"",btns:"",useFix:false,backButtonClick:function(){history.back(1)},_isShow:false},_create:function(){var c=this,d=c._data;(c.root()||c.root(a("<div></div>"))).addClass("ui-toolbar").appendTo(c.data("container")||(c.root().parent().length?"":document.body)).html((function(){var e='<div class="ui-toolbar-wrap"><div class="ui-toolbar-left">';if(d.backButtonHref){e+='<a class="ui-toolbar-backbtn" href="'+d.backButtonHref+'">'+d.backButtonText+"</a></div>"}else{e+='<span class="ui-toolbar-backbtn">'+d.backButtonText+"</span></div>"}e+=d.title?'<h2 class="ui-toolbar-title">'+d.title+"</h2>":"";e+='<div class="ui-toolbar-right"></div></div>';return e}()));if(d.btns){var b=c.root().find(".ui-toolbar-right");a(d.btns).each(function(e,f){b.append(f)})}},_setup:function(d){var f=this,g=f.root().addClass("ui-toolbar");if(!d){var i=g.children(),h=g.find("h1,h2,h3,h4"),e=h.index(),c=a('<div class="ui-toolbar-left"></div>'),j=a('<div class="ui-toolbar-right"></div>'),b=a('<div class="ui-toolbar-wrap"></div>');g.empty().append(b.append(c).append(j));if(e==-1){i.each(function(k,l){a(l).appendTo(k==0?c:j)})}else{i.each(function(k,l){if(k<e){c.append(l)}else{if(k==e){b.append(a(l).addClass("ui-toolbar-title"))}else{j.append(l)}}})}c.children().first().addClass("ui-toolbar-backbtn");f.data("btns")&&a(f.data("btns")).each(function(k,l){j.append(l)});f.data("container")&&g.appendTo(f.data("container"))}},_init:function(){var e=this,c=e.root(),f=c.find(".ui-toolbar-backbtn");if(e.data("useFix")){var h=a('<div class="ui-toolbar-placeholder"></div>').height(c.offset().height).insertBefore(c).append(c).append(c.clone().css({"z-index":1,position:"absolute",top:0})),g=c.offset().top,b=function(){document.body.scrollTop>g?c.css({position:"fixed",top:0}):c.css("position","absolute")},d;a(window).on("touchmove touchend touchcancel scroll scrollStop",b);a(document).on("touchend touchcancel",function(){d=arguments.callee;a.later(b,200)});e.on("destroy",function(){a(window).off("touchmove touchend touchcancel scroll scrollStop",b);a(document).off("touchend touchcancel",d);h.off().remove()}).on("init",b)}f.highlight("ui-state-hover").is("a")||f.click(e.data("backButtonClick"));return e},addButton:function(d){var c=this,b=c.root().find(".ui-toolbar-right");a.each(d,function(f,e){b.append(e.root());c.component(e)});return c},show:function(){var b=this;b.data("_isShow",true);b.root().show();b.trigger("show");return b},hide:function(){var b=this;b.data("_isShow",false);b.root().hide();b.trigger("hide");return b},toggle:function(){var b=this;b.data("_isShow")?b.hide():b.show();return b}})})(Zepto);