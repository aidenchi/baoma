(function(b,c){var d=b.fx.cssPrefix,a=b.fx.transitionEnd;b.ui.define("panel",{_data:{contentWrap:"",scrollMode:"follow",display:"push",position:"right",dismissible:true,swipeClose:true,beforeopen:null,open:null,beforeclose:null,close:null},_create:function(){throw new Error("panel\u7ec4\u4ef6\u4e0d\u652f\u6301create\u6a21\u5f0f\uff0c\u8bf7\u4f7f\u7528setup\u6a21\u5f0f")},_setup:function(){var f=this,g=f._data,e=f.root().addClass("ui-panel ui-panel-"+g.position);f.panelWidth=e.width()||0;f.$contentWrap=b(g.contentWrap||e.next());g.dismissible&&(f.$panelMask=b('<div class="ui-panel-dismiss"></div>').width(document.body.clientWidth-e.width()).appendTo("body")||null)},_init:function(){var e=this,f=e._data;e.displayFn=e._setDisplay();e.$contentWrap.addClass("ui-panel-animate");e.root().on(a,b.proxy(e._eventHandler,e)).hide();f.dismissible&&e.$panelMask.hide().on("click",b.proxy(e._eventHandler,e));f.scrollMode!=="follow"&&b(document).on("scrollStop",b.proxy(e._eventHandler,e));b(window).on("ortchange",b.proxy(e._eventHandler,e))},_setDisplay:function(){var i=this,k=i.root(),f=i.$contentWrap,e=d+"transform",l=i._transDisplayToPos(),j={},h,g;b.each(["push","overlay","reveal"],function(m,n){j[n]=function(p,q,o){h=l[n].panel,g=l[n].cont;k.css(e,"translate3d("+i._transDirectionToPos(q,h[p])+"px,0,0)");if(!o){f.css(e,"translate3d("+i._transDirectionToPos(q,g[p])+"px,0,0)");i.maskTimer=b.later(function(){i.$panelMask&&i.$panelMask.css(q,k.width()).toggle(p)},400)}return i}});return j},_initPanelPos:function(e,f){this.displayFn[e](0,f,true);this.root().get(0).clientLeft;return this},_transDirectionToPos:function(f,e){return f==="left"?e:-e},_transDisplayToPos:function(){var e=this,f=e.panelWidth;return{push:{panel:[-f,0],cont:[0,f]},overlay:{panel:[-f,0],cont:[0,0]},reveal:{panel:[0,0],cont:[0,f]}}},_setShow:function(f,g,n){var m=this,k=m._data,l=f?"open":"close",o=b.Event("before"+l),j=f!==m.state(),e=f?"on":"off",h=f?b.proxy(m._eventHandler,m):m._eventHandler,i=g||k.display,p=n||k.position;m.trigger(o,[g,n]);if(o.defaultPrevented){return m}if(j){m._dealState(f,i,p);m.displayFn[i](m.isOpen=Number(f),p);k.swipeClose&&m.root()[e](b.camelCase("swipe-"+p),h);k.display=i,k.position=p}return m},_dealState:function(e,g,k){var i=this,h=i._data,l=i.root(),f=i.$contentWrap,m="ui-panel-"+g+" ui-panel-"+k,j="ui-panel-"+h.display+" ui-panel-"+h.position+" ui-panel-animate";if(e){l.removeClass(j).addClass(m).show();h.scrollMode==="fix"&&l.css("top",b(window).scrollTop());i._initPanelPos(g,k);if(g==="reveal"){f.addClass("ui-panel-contentWrap").on(a,b.proxy(i._eventHandler,i))}else{f.removeClass("ui-panel-contentWrap").off(a,b.proxy(i._eventHandler,i));l.addClass("ui-panel-animate")}i.$panelMask&&i.$panelMask.css({left:"auto",right:"auto",height:document.body.clientHeight})}return i},_eventHandler:function(i){var g=this,h=g._data,j=h.scrollMode,f=g.state()?"open":"close";switch(i.type){case"click":case"swipeLeft":case"swipeRight":g.close();break;case"scrollStop":j==="fix"?g.root().css("top",b(window).scrollTop()):g.close();break;case a:g.trigger(f,[h.display,h.position]);break;case"ortchange":g.$panelMask&&g.$panelMask.css("height",document.body.clientHeight);j==="fix"&&g.root().css("top",b(window).scrollTop());break}},open:function(f,e){return this._setShow(true,f,e)},close:function(){return this._setShow(false)},toggle:function(f,e){return this[this.isOpen?"close":"open"](f,e)},state:function(){return !!this.isOpen},destroy:function(){this.$panelMask&&this.$panelMask.off().remove();this.maskTimer&&clearTimeout(this.maskTimer);this.$contentWrap.removeClass("ui-panel-animate");b(document).off("scrollStop",this._eventHandler);b(window).off("ortchange",this._eventHandler);return this.$super("destroy")}})})(Zepto);