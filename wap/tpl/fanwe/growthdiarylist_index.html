{include file="./inc/header_common.html"}
<style>
.growth_diary_top{
	background: #A2CEA0;
	width: 100%;
	position: relative;
}
.growth_diary_date{
	width: 100%;
	height: 40px;	
}
.growth_diary_user {
	width: 100%;
	height: 180px;	
	text-align: center;
}
.growth_circle{
	width: 100%;
	height: 30px;
	background: #999999;
	opacity: 0.5;
	filter:alpha(opacity=50)
}
.growth_diary_list_table {
	width:100%;
	color: #adadad;
	font-size:12px;
}
.growth_diary_list_table a{
	color: #adadad;
}
.td_line{
	line-height: 22px;
	padding: 10px;
	border-bottom: 1px solid #f5f5f5;
}
.pic_item {
	position: relative;
	width: 100px;
	height: 100px;
	float: left;
	display: inline-block;
	margin-top: 5px;
	margin-right: 5px;
}
</style>
			<div class="growth_diary_top">
				<div class="growth_diary_date">
					<div style="float:left;width:50%;text-align:left;">
						<a href='{wap_url a="index" r="growthdiarydate#index"}'>
							<span>日历</span>
						</a>
					</div>
					<div style="float:left;width:50%;text-align:right;">
						<a href='{wap_url a="index" r="growthdiarywrite#index"}'>
							<span>记录</span>		
						</a>
					</div>
				</div>
				<div class="growth_diary_user">
					<img style="border-radius:60px;" src='{function name="get_user_avatar" uid=$data.login_user_id type="middle" }'>
					<br/>
					<span style="color:#fff; font-size:18px; line-height:24px;">{$data.login_user_name}</span><br/>
					<span style="color:#fff; font-size:18px; line-height:24px;">{function name="get_user_age_byid" uid=$data.login_user_id}</span>
				 </div>	
				 <div class="growth_circle">
					<a href='{wap_url a="index" r="growthdiarylist_public#index"}'>
						<span style="padding-left:10px;line-height:30px;font-size:16px;color:#fff;font-weight:bold"><成长圈</span>
					</a>
				 </div>
			</div>
			
			<div class="wrap">
					{if $data.growth_diary_list}					
					<div class="list-view">
						<div class="list_title">共{$data.total}篇日记</div>
						<table cellspacing="0" cellpadding="0" border="0" class="growth_diary_list_table">							
							{foreach from=$data.growth_diary_list item=growth_diary}								
							<tbody id="growth_diary_{$growth_diary.id}">
								<tr>
									<td class="td_line" width="50" style="text-align:center;" valign="top">
										<span style="font-size:20px;">{$growth_diary.record_month}.{$growth_diary.record_day}</span>
									</td>								
									<td class="td_line">	
										<table cellspacing="0" cellpadding="0" border="0" width="100%">		
											<tr>								
												<td>
													<!--文字内容-->
													<a style="font-size:14px;" href='{wap_url a="index" r="growthdiaryitem#index"  p="id=$growth_diary.id"}'>
													{$growth_diary.short_content}	
													</a>
													<!--图片内容-->
													{if $growth_diary.has_pic}
													<br/>										
													{foreach from=$growth_diary.pic_list item=pic_item}
														<div class='pic_item'>
															<img src='{$pic_item.small_preview_path}' />
														</div>
													{/foreach}
													{/if}
												</td>
												<td width="35px;" align="right" valign="top" >	
													<!--
													<a style="color: #adadad;" href='{wap_url a="index" r="growthdiarywrite#index"  p="id=$growth_diary.id"}'><i style="color:red;">编辑</i></a>&nbsp;
													-->
													<a style="color: #adadad;" href="javascript:void(0);" onclick="delete_growth_diary({$growth_diary.id},$('#growth_diary_{$growth_diary.id}'));"><i style="color:red;">删除</i></a>				
												</td>
											</tr>	
											<tr>								
												<td style="padding-top:10px;">
													{if $growth_diary.is_public eq 1}
													<span style="padding-right:3px;">喜欢({$growth_diary.fav_count})</span>										
													<a href='{wap_url a="index" r="growthdiaryitem#index"  p="id=$growth_diary.id"}'>
														<span style="padding-right:10px;color:#adadad;">评论({$growth_diary.reply_count})</span>
													</a>
													{/if}										
													<span>{function name="pass_date" time=$growth_diary.create_time }</span>		
												</td>
												<td width="35px;" align="right">	
													{if $growth_diary.is_public eq 1}
														<span style="cursor:pointer;" id="public_status_{$growth_diary.id}" onclick="change_public_status({$growth_diary.id})">公开</span>
													{/if}
													{if $growth_diary.is_public eq 0}
														<span style="cursor:pointer;" id="public_status_{$growth_diary.id}" onclick="change_public_status({$growth_diary.id})">私有</span>
													{/if}
												</td>
											</tr>				
										</table>									
									</td>
								</tr>						
							</tbody>
							{/foreach}							
						</table>
						<!--分页-->
						<div class="fy">
							{$pages}
						</div>
					</div><!--list-view end-->	
					{else}
					<div style="margin-top:10px;margin-bottom:10px;text-align:center;">
					暂无成长日记
					</div>
					{/if}					
					
				</div><!--wrap end-->		

<script type="text/javascript">
function change_public_status(growth_diary_id){
	var public_status_id = "public_status_"+growth_diary_id;
	//alert(public_status_id);
	var query = new Object();
	query.growth_diary_id = growth_diary_id;
	query.post_type = "json";
	var ajaxurl = '{wap_url a="index" r="growthdiarypublicstatus#index"}';
	$.ajax({
		url:ajaxurl,
		data:query,
		type:"post",
		dataType:"json",
		success:function(data){
			if(data.status==1){
				if(data.public_status == 0){
					document.getElementById(public_status_id).innerText = "私有";	
				}
				if(data.public_status == 1){
					document.getElementById(public_status_id).innerText = "公开";	
				}
				alert(data.info);
			}else{
				alert(data.info);
			}
		}
		,error:function(){
			alert("服务器提交错误");
		}
	});
}

function delete_growth_diary(growth_diary_id,one_growth_diary_obj){
	var query = new Object();
	query.id = growth_diary_id;
	query.post_type = "json";
	var ajaxurl = '{wap_url a="index" r="growthdiarydel#index"}';
	//alert(query.topic_id);
	$.ajax({
		url:ajaxurl,
		data:query,
		type:"post",
		dataType:"json",
		success:function(data){
			if(data.status==1){ 
				one_growth_diary_obj.remove();
				//alert(data.info);
			}else{
				alert(data.info);
			}
		}
		,error:function(){
			alert("服务器提交错误");
		}
	});
}
</script>				
{include file="./inc/footer.html"}				
			