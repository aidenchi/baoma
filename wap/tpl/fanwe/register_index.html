<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />	
    <!-- Mobile Devices Support @begin -->
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="false" name="twcClient" id="twcClient">
    <meta content="no-cache,must-revalidate" http-equiv="Cache-Control">
    <meta content="no-cache" http-equiv="pragma">
    <meta content="0" http-equiv="expires">
    <!--允许全屏模式-->
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <!--指定sari的样式-->
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta content="telephone=no" name="format-detection" />
    <!-- Mobile Devices Support @end -->
	<title>{$data.page_title}</title>
	{include file="./inc/common.html"}
</head> 
<body>
	{include file="./inc/header.html"}
	{include file="./inc/pop.html"}
	
	<div class="wrap">

		<div class="content">
		<div class="comment_list_txt">
			<form id="normal-register-form" action="{wap_url a="index" r="register"}" autocomplete="off" method="post" onsubmit="return check(this)">
			 <div class="Menubox">
				<ul>
				   <li id="one1" class="hover">账号注册<a style="float:right;padding-right:10px;" href='{url a="index" r="login#index"}'>登录</a></li>
				</ul>
			 </div>
			 <div class="Contentbox">				
					<div class="inputtxt">
					<div class="inputpc"><i class="fa fa-envelope"></i></div>	
					<div class="input_sr"><input type="text" placeholder="请输入邮箱" name="email" id="email"></div>
					</div>		   
					<div class="inputtxt">
					<div class="inputpc"><i class="fa fa-user"></i></div>	
					<div class="input_sr"><input type="text" placeholder="请输入昵称" name="user_name" id="user_name"></div>
					</div>
					<div class="inputtxt"> 
					<div class="inputpc"><i class="fa fa-lock"></i></div>
					<div class="input_sr"><input type="password" placeholder="请输入密码" name="pwd" id="pwd"></div>	 
					</div>
					<div class="inputtxt"> 
					<div class="inputpc"><i class="fa fa-lock"></i></div>
					<div class="input_sr"><input type="password" placeholder="请再次输入密码" name="ppwd" id="ppwd"></div>	 
					</div>
					<div class="inputtxt2 chk"> 
					<span class="chk_sp1">选择性别:</span>
					<input class="mt_sex" type="radio" name="sex" value="1" /><span class="chk_sp2">男</span>
					<input class="mt_sex" type="radio" name="sex" value="0"/><span class="chk_sp2">女</span>
					</div>
					<div class="btn_login">
					{if $ref_uid}<input type="hidden" name="ref_uid" id="ref_uid" value="{$ref_uid}">{/if}
					<input  type="submit"  name="Submit" class="mj-submit" value="注册" 	style="background: none;">
					</div>
			 </div>
						
			</form>
		 </div>
		</div>
	</div>	

	{include file="./inc/footer.html"} 
	
	<script type="text/javascript">
	function  check(){	
		var obj1=$("#email").val();
		var obj2=$("#user_name").val();
		var obj3=$("#pwd").val();
		var obj4=$("#ppwd").val();
		var obj5=$("input[name='sex']:checked").val();
		var obj6=$("#ref_uid").val();
		var myreg = /^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;
		if(!obj1){
			//alert("请填写邮箱");
			$("#alert_content").html("请填写邮箱");
			$('#my-alert').modal({
				relatedTarget: this,
			});
			setTimeout(function(){
				$('#my-alert').modal('close');
			},1000);
			return false;	
		}
		if(!myreg.test(obj1)){
			//alert('提示\n\n请输入有效的E_mail！');
			$("#alert_content").html("请输入有效的E_mail！");
			$('#my-alert').modal({
				relatedTarget: this,
			});
			setTimeout(function(){
				$('#my-alert').modal('close');
			},1000);
			return false;
		   }
		if(!obj2){
			//alert("请填昵称");
			$("#alert_content").html("请填昵称");
			$('#my-alert').modal({
				relatedTarget: this,
			});
			setTimeout(function(){
				$('#my-alert').modal('close');
			},1000);
			return false;
		}
		if(!obj3){
			//alert("请填密码");
			$("#alert_content").html("请填密码");
			$('#my-alert').modal({
				relatedTarget: this,
			});
			setTimeout(function(){
				$('#my-alert').modal('close');
			},1000);
			return false;		
		}	
		if(!obj4){
			//alert("请填确认密码");
			$("#alert_content").html("请填确认密码");
			$('#my-alert').modal({
				relatedTarget: this,
			});
			setTimeout(function(){
				$('#my-alert').modal('close');
			},1000);
			return false;		
		}
		if(!obj5){
			//alert("选择性别");
			$("#alert_content").html("选择性别");
			$('#my-alert').modal({
				relatedTarget: this,
			});
			setTimeout(function(){
				$('#my-alert').modal('close');
			},1000);
			return false;		
		}
		if(obj3!=obj4){
			//alert("两次密码不一致");
			$("#alert_content").html("两次密码不一致");
			$('#my-alert').modal({
				relatedTarget: this,
			});
			setTimeout(function(){
				$('#my-alert').modal('close');
			},1000);
			return false;	
		}	
		var query = new Object();
		query.email = obj1;
		query.user_name = obj2;
		query.password=obj3;
		query.gender = obj5;
		query.ref_uid=obj6;
		query.post_type = "json";
		var ajaxurl = 	$("#normal-register-form").attr("action");
		$.ajax({
			url:ajaxurl,
			data:query,
			type:"post",
			dataType:"json",
			success:function(data){
				if(data.status==1){ 	
					//alert(data.info);
					window.location.href="{wap_url a="index" r="user_center#index"}";
				}else{
					//alert(data.info);
					$("#alert_content").html(data.info);
					$('#my-alert').modal({
						relatedTarget: this,
					});
				}
			}
			,error:function(){
				//alert("服务器提交错误");
				$("#alert_content").html("服务器提交错误，请稍后重新操作");
				$('#my-alert').modal({
					relatedTarget: this,
				});
			}
		});	
			return false;
		}
	</script>					
	
</body>
</html>	